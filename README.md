# ML-MicroCases2
机器学习微案例

客户价值预测就是指预测客户在未来一段时间内能带来多少利
润，其利润可能来自信用卡的年费、取现手续费、分期手续费、境外
交易手续费等。分析出客户价值后，在进行营销、电话接听、催收、
产品咨询等各项业务时，就可以针对高价值客户提供区别于普通客户
的服务，以进一步挖掘这些高价值客户的价值。


数据中存在，'历史贷款金额', '贷款次数', '学历', '月收入', '性别','客户价值'五列。其中客户价值为目标值，其余四列为特征值。

我们将采用五个模型分别对数据进行模型训练。并采用评价指标为：R方和Adjusted R方衡量模型在“考虑特征数量后”的拟合优度，以及p值，P 值衡量的是“变量对结果是否显著”的概率指标，用于线性回归。P 越小，说明变量对模型越重要，关系越可信。P < 0.05：显著（说明这个变量对结果有统计学意义）、P < 0.01：非常显著、P ≥ 0.05：不显著（可能是噪声，不是关键因素）。


(1) 线性回归 (Linear Regression)

优点：
简单易理解，训练速度快。
对于线性关系的数据，解释性强（可以直接看回归系数）。
可以计算 P 值，判断特征显著性。

缺点：
对非线性关系拟合效果差。
对异常值敏感。
多特征且存在共线性时，可能出现不稳定系数。

运行结果分析：
R² = 0.5707，说明仅约 57% 的客户价值变化可以由这些特征线性解释。
说明客户价值与特征间存在一定非线性关系，线性回归拟合效果一般。


(2) 二次多项式回归 (Polynomial Regression, degree=2)

优点：
可以拟合一定的非线性关系。
对于非线性趋势比线性回归更灵活。

缺点：
高阶多项式容易过拟合（尤其样本量较少时）。
解释性下降，P 值不容易直接解读。

运行结果分析：
R² = 0.6652，较线性回归提升约 10%，说明二次项可以捕捉一些非线性变化。
调整后R² = 0.6026，下降幅度较大 → 存在一定过拟合风险。
因此对训练数据有提升，但泛化能力可能不稳定。


(3) 岭回归 (Ridge Regression)

优点：
可以处理多重共线性问题。
带正则化，避免模型过拟合。

缺点：
对高度非线性关系改善有限。
不提供 P 值，解释性差。

运行结果分析：
R² ≈ 线性回归（0.5707），说明数据非线性因素主导，正则化对拟合提升有限。
适合防止特征权重过大，但无法解决非线性问题。


(4) 支持向量回归 (SVR, RBF核)

优点：
强大的非线性拟合能力。
对高维特征和异常值较鲁棒。
适合小样本回归问题。

缺点：
模型黑盒，不易解释。
对超参数敏感（C、gamma、epsilon）。
训练时间可能较长。

运行结果分析：
R² = 0.8032，显著高于线性、岭、多项式回归 → 非线性模型更适合此数据。
调整后R² = 0.7951，说明模型拟合合理，过拟合风险低
非线性关系在客户价值中很明显，SVR捕捉效果最好。


(5) KNN 回归 (k=3)

优点：
非参数方法，无需假设数据分布。
可以捕捉局部非线性模式。

缺点：
对数据噪声敏感。
对 k 值和距离度量敏感。
高维数据下可能退化（“维度灾难”）。

运行结果分析：
R² = 0.6264，中等水平。
调整后R² = 0.6111 → 拟合局部模式，但整体表现略逊于 SVR。
适合简单局部关系建模，但多特征影响效果。


模型评价汇总：

<img width="1164" height="438" alt="image" src="https://github.com/user-attachments/assets/013ecd6c-4519-4ce6-b295-e06a8d67374a" />


<img width="1650" height="879" alt="image" src="https://github.com/user-attachments/assets/7d21a687-2b08-4569-85be-dec6542c56d0" />


模型p值：

<img width="924" height="387" alt="image" src="https://github.com/user-attachments/assets/78248b29-b7ab-40e1-bde8-a5eff53aaa85" />

结论：
线性回归中，客户价值主要受历史贷款金额、贷款次数、学历和月收入影响，而性别几乎没有影响。

<img width="902" height="1155" alt="image" src="https://github.com/user-attachments/assets/f90d678d-afcf-47f8-9ea8-87771de564a4" />

结论：

多项式回归中，一些二次项和交互项变得显著：
历史贷款金额²、历史贷款金额 × 月收入、历史贷款金额 × 性别、学历 × 性别。
原始的一次项（历史贷款金额、贷款次数、学历、月收入、性别）在多项式回归中不显著。
说明非线性关系和交互效应对客户价值有影响，但线性关系可能被多项式复杂化掩盖。

总结分析：

数据特点：
客户价值与历史贷款金额、贷款次数、月收入等特征存在一定非线性关系。
性别和学历可能对整体贡献有限，线性模型难以充分捕捉。

模型表现：
SVR (RBF) > 二次多项式回归 > KNN回归 > 线性/岭回归

原因：
RBF核可以捕捉复杂非线性模式，适合客户价值预测。
KNN捕捉局部模式，但全局拟合不如 SVR。
多项式回归改善部分非线性，但易过拟合。
线性与岭回归只能捕捉线性趋势，效果一般。

建议：
对于客户价值预测，推荐使用 SVR 或者调整后的多项式回归。
线性回归可用于快速初步分析或解释单个特征作用。
KNN可作为辅助模型验证局部趋势。
